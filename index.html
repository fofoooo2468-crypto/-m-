<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>أداة تحليل وصياغة المهام التنظيمية</title>

<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#f5ede3;
  --card:#ffffff;
  --border:#e0d6c8;
  --gold:#d7a562;
  --navy:#174766;
  --ink:#00080b;
  --radius:10px;
  --shadow:0 2px 6px rgba(0,0,0,.08);
}

body{
  font-family:"Cairo",sans-serif;
  background:var(--bg);
  margin:0;
  padding:24px;
  color:var(--ink);
}

.container{max-width:1100px;margin:auto;}

.panel{
  background:var(--card);
  padding:16px;
  border-radius:var(--radius);
  box-shadow:var(--shadow);
}

textarea{
  width:100%;
  height:120px;
  padding:12px;
  border-radius:var(--radius);
  border:1px solid var(--border);
  font-family:inherit;
}

.actions{margin-top:10px;display:flex;gap:8px;}
button{
  padding:8px 14px;
  border-radius:var(--radius);
  font-family:inherit;
  cursor:pointer;
  border:none;
}
.btn-primary{background:var(--gold);}
.btn-secondary{background:var(--navy);color:#fff;}
.btn-ghost{background:transparent;border:1px solid var(--border);}

.task-card{
  background:var(--card);
  padding:16px;
  margin-top:16px;
  border-radius:var(--radius);
  box-shadow:var(--shadow);
}

table{
  width:100%;
  border-collapse:collapse;
  margin-top:12px;
}
th,td{
  border:1px solid var(--border);
  padding:8px;
  vertical-align:top;
}
th{background:#f1e8dc;text-align:center;}

.warn{color:#b00000;font-size:13px;}
.ok{color:#0a6b34;font-size:13px;}

.suggest{
  background:#f9f5ef;
  padding:10px;
  border-radius:8px;
  margin-top:8px;
}

.approved{
  background:#e9f5ef;
  padding:10px;
  border-radius:8px;
  margin-top:6px;
}
</style>
</head>

<body>
<div class="container">

<div class="panel">
<h3>أدخل مهمة أو أكثر (كل مهمة بسطر):</h3>
<textarea id="input"></textarea>
<div class="actions">
  <button class="btn-primary" onclick="analyze()">تحليل</button>
  <button class="btn-ghost" onclick="clearAll()">مسح</button>
</div>
</div>

<div id="results"></div>

<div class="task-card">
<h3>الصياغات المعتمدة</h3>
<div id="approvedList"></div>
</div>

</div>

<script>
const VERBS = ["تنظيم","توجيه","تحفيز","إشراف","متابعة","رقابة","تنفيذ","تطوير","تقييم","اعتماد"];

function analyze(){
  const container=document.getElementById("results");
  container.innerHTML="";

  const lines=document.getElementById("input").value
    .split("\n").map(l=>l.trim()).filter(Boolean);

  lines.forEach((text,i)=>{
    const verbsFound=VERBS.filter(v=>text.includes(v));

    // المجال = النص بدون الأفعال فقط
    let domain=text;
    verbsFound.forEach(v=>{
      domain=domain.replace(new RegExp(v,"g"),"").trim();
    });

    const card=document.createElement("div");
    card.className="task-card";

    let table=`
    <table>
      <tr>
        <th>الفعل</th>
        <th>المجال</th>
        <th>الأداة</th>
        <th>المخرج</th>
      </tr>
      <tr>
        <td>${verbsFound.join("، ")||"-"}</td>
        <td>${domain||"-"}</td>
        <td>-</td>
        <td>-</td>
      </tr>
    </table>`;

    let evalHtml="";
    let suggestHtml="";

    if(verbsFound.length>1){
      evalHtml=`<div class="warn">
      ⚠ النص يحتوي على ${verbsFound.length} أفعال تنظيمية → يُقترح فصله إلى ${verbsFound.length} مهام مستقلة
      </div>`;

      suggestHtml="<h4>مقترحات فصل وصياغة كاملة:</h4>";

      verbsFound.forEach(v=>{
        const s=`${v} ${domain}`;
        suggestHtml+=`
        <div class="suggest">
          ${s}
          <button class="btn-secondary" onclick="approve('${s.replace(/'/g,"")}')">اعتماد</button>
        </div>`;
      });
    } else {
      const s=`${verbsFound[0]||"تنظيم"} ${domain}`;
      suggestHtml=`
      <h4>مقترح صياغة منضبطة:</h4>
      <div class="suggest">
        ${s}
        <button class="btn-secondary" onclick="approve('${s.replace(/'/g,"")}')">اعتماد</button>
      </div>`;
    }

    card.innerHTML=`
    <h4>المهمة ${i+1}</h4>
    ${table}
    ${evalHtml}
    ${suggestHtml}
    `;
    container.appendChild(card);
  });
}

function approve(text){
  const list=document.getElementById("approvedList");
  const div=document.createElement("div");
  div.className="approved";
  div.textContent=text;
  list.appendChild(div);
}

function clearAll(){
  document.getElementById("input").value="";
  document.getElementById("results").innerHTML="";
}
</script>
</body>
</html>
